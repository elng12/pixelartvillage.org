# 国际化（i18n）专项审计报告

## 执行摘要

本次对 Pixel Art Village 项目的国际化（i18n）专项审计显示，其多语言支持能力处于**高度不成熟**的状态。尽管项目在基础架构层面（如路由策略）有合理的设计，但在代码实现、内容管理和质量保证等关键环节存在**致命缺陷**。最主要的三大风险点是：**1) 大量的硬编码文本**，导致大部分组件无法被翻译；**2) 开发者对i18n基本原则和工具的普遍误解**，导致功能失效；**3) 缺乏自动化的工作流和测试**，使得问题持续产生且无法被发现。若不进行系统性整改，本项目的多语言功能将形同虚设，无法支撑任何全球化业务目标。

**最高优先级建议**：立即在开发流程中强制集成“伪本地化（Pseudo-localization）”测试，并对全体开发人员进行一次关于i18n最佳实践的强制性培训。

---

## 分阶段详细报告

### 第一阶段：基础架构与路由策略

| 风险等级 | 审计领域 | 问题定位 | 问题描述与业务影响 | 战略整改建议 |
| :--- | :--- | :--- | :--- | :--- |
| **警告** | 核心配置 | `src/i18n.js` | 配置中使用了 `useSuspense: false`。这可能导致在翻译资源加载完成前，用户看到翻译密钥或旧语言的文本，造成UI闪烁和体验不一致。 | 建议将 `useSuspense` 设置为 `true`，并使用React的 `<Suspense>` 组件为页面或组件提供优雅的加载状态（fallback UI），这是更现代、更可靠的模式。 |
| **警告** | 路由实现 | `src/App.jsx` | `useLangRouting` 钩子通过注释禁用了 `exhaustive-deps` 的lint规则，以避免添加 `navigate` 依赖。这是一种技术债，可能在未来React或React Router版本更新后引发无限循环的bug。 | 移除`eslint-disable-line`注释，并将`navigate`函数添加到`useEffect`的依赖数组中。遵循React Hooks的最佳实践，确保代码的长期稳定性。 |

### 第二阶段：代码实现与文本外化

| 风险等级 | 审计领域 | 问题定位 | 问题描述与业务影响 | 战略整改建议 |
| :--- | :--- | :--- | :--- | :--- |
| **致命** | 文本外化 | `src/components/` 全域 | 大量的UI组件（About, Contact, Editor, Footer等）中充满了硬编码的英文字符串。这使得这些组件完全无法被翻译，多语言功能因此失效，严重阻碍产品触达非英语用户。 | **立即行动**：对整个代码库进行一次地毯式排查，将所有面向用户的硬编码文本替换为i18n的翻译密钥，并添加到语言资源文件中。 |
| **致命** | 工具使用 | `FaqSection.jsx`, `HowItWorksSection.jsx` 等 | 开发者普遍未能正确使用 `useTranslation` 这个React Hook，有的在组件外调用，有的导入后忘记调用。这直接导致组件渲染时因找不到 `t` 函数而崩溃，是i18n功能失效的直接原因。 | **组织培训**：对所有前端开发者进行一次关于React Hooks核心规则和`react-i18next`库用法的强制性培训，确保每个人都掌握基本用法。 |
| **严重** | 实现不一致 | `ShowcaseSection.jsx` | 在同一个组件中，部分文本使用了 `t()` 函数，而紧邻的标题（如`Before`/`After`）却是硬编码。这种不一致性体现了开发的随意性，增加了维护成本和缺陷风险。 | 制定并强制执行编码规范：**项目中不允许存在任何面向用户的硬编码字符串**。通过Code Review和自动化工具来保障此规范的落地。 |

### 第三阶段：内容工作流与本地化（L10n）流程

| 风险等级 | 审计领域 | 问题定位 | 问题描述与业务影响 | 战略整改建议 |
| :--- | :--- | :--- | :--- | :--- |
| **严重** | 内容管理 | `public/locales/` | 所有翻译都存放在一个巨大的单一 `translation.json` 文件中。当项目规模扩大、团队成员增多时，维护这个文件会成为噩梦，极易产生合并冲突，降低开发效率。 | 按照功能或页面（Namespace）将大的翻译文件拆分成多个小文件。例如，`footer.json`, `editor.json`等。这能有效降低冲突，使职责更清晰。 |
| **严重** | L10n流程 | `package.json` | 缺乏任何用于管理i18n资源的自动化脚本。开发者手动添加密钥、翻译人员手动更新文件的方式，效率低下且极易出错，是导致翻译内容不一致的根源。 | **引入工具**：集成如 `i18next-parser` 这样的工具，自动从代码中扫描并提取新的翻译密钥。并建立一个流程，检查不同语言文件间的密钥差异，实现流程自动化。 |

### 第四阶段：质量保证与测试策略

| 风险等级 | 审计领域 | 问题定位 | 问题描述与业务影响 | 战略整改建议 |
| :--- | :--- | :--- | :--- | :--- |
| **致命** | 测试策略 | 项目全局 | **完全缺失伪本地化（Pseudo-localization）流程**。这是导致硬编码文本泛滥的核心原因。没有这个机制，开发者在开发时无法直观地发现未经翻译的字符串。 | **最高优先级**：立即在开发环境中引入伪本地化。创建一个如 `en-PSEUDO` 的语言，其翻译文件自动将所有英文字符串转换为如 `[!!! Ęñĝłĩšħ !!!]` 的形式。让UI测试和开发人员在日常开发中就能即时发现i18n问题。 |
| **严重** | 自动化测试 | `tests/i18n.spec.js` | 现有的i18n测试覆盖面极窄，仅验证了一个UI元素的文本变化，无法有效保障语言切换、路由跳转、内容完整性等关键功能的正确性。 | **扩展测试**：编写更多的E2E测试用例，覆盖以下场景：1. 首次访问的语言重定向。 2. 在不同页面切换语言后，URL和页面内容均按预期更新。 3. 在伪本地化语言下运行测试，断言页面上不应出现任何未转换的（正常的）英文字符串。 |
